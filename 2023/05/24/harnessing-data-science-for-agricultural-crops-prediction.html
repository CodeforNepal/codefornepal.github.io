<!DOCTYPE html>
<html>

<head>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-66983412-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-66983412-1');
  </script>
  <!-- End Google Analytics -->
  

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Community of volunteers helping address Nepal's challenges using civic tech to innovate, organize and advocate digital literacy">
  <meta name="author" content="">
  <meta name="keyword" content="code for nepal, c4n, volunteer, code, nepal" />
  <meta property="og:locale" content="en_US">
  <meta property="fb:pages" content="201272103415379">

  <meta property="og:type" content="website">
<meta property="og:title" content="Harnessing Data Science For Agricultural Crops Prediction">
<meta property="og:description" content="">
<meta property="og:url" content="/2023/05/24/harnessing-data-science-for-agricultural-crops-prediction.html">
<meta property="og:site_name" content="Code for Nepal">
<meta property="og:image" content="">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="">
<meta name="twitter:title" content="Harnessing Data Science For Agricultural Crops Prediction">
<meta name="twitter:site" content="@codefornepal">
<meta name="twitter:image" content="">
<link rel="canonical" href="https://codefornepal.org/">
<link rel="icon" href="/assets/img/c4n-icon.jpg">


  <title>
    
    Harnessing Data Science For Agricultural Crops Prediction | Code for Nepal
    
  </title>

  <!-- Bootstrap core CSS -->
  <!-- <link href="/assets/css/bootstrap.min.css" rel="stylesheet"> -->

  <!-- Custom fonts for this template -->
  <link href="/assets/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet'
    type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this theme -->
  <link href="/assets/css/agency.css" rel="stylesheet">

  <!-- Page container change top padding when nav shrinks -->
  
  <style>
    #pagecontainer {
      padding-top: 150px;
    }

    @media only screen and (max-width: 991px) {
      #pagecontainer {
        padding-top: 100px;
      }
    }
  </style>
  

</head>

<body id="page-top">

	<!-- Navigation -->
<nav class="navbar navbar-dark navbar-expand-lg fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand js-scroll-trigger" href="/">
      
      <img height="52" src="/assets/img/c4n_logo.png" />
      
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
      data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
      aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav text-uppercase ml-auto d-flex align-items-center">
        
        <li class="nav-item">
          
          <a class="nav-link js-scroll-trigger" href="/#about">About</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link js-scroll-trigger" href="/fellowship2025/">Data Fellowship</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link js-scroll-trigger" href="/blog/">Blog</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link js-scroll-trigger" href="/team/">Team</a>
          
        </li>
        
        <li class="nav-item">
          
          <a class="nav-link js-scroll-trigger" href="/joinus/">Join us</a>
          
        </li>
        
        </li>
        <!--Paypal Button-->
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
    <input type="hidden" name="cmd" value="_s-xclick" />
    <input type="hidden" name="hosted_button_id" value="A8L4MMC7NP5ZS"/>
    <button id="donate-btn" class="btn btn-sm btn-primary" type="submit">
      <span>Donate</span>
    </button>
    <img src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" />
  </form>

      </ul>
    </div>
  </div>
</nav>
<!-- End Navigation -->



<div class="container blog" id="pagecontainer">
  <div class="row">
  <div class="col-md-12">
    <h1 class="title">Harnessing Data Science For Agricultural Crops Prediction</h1>
    <p>24 May 2023 - Sadhana Panthi</p>
    <p>
      <p>Using AI to determine optimal crop selection can have a significant impact on ending world hunger, particularly in poor developing countries like Nepal. Even though Nepal is an agricultural country, we import a huge amount of food materials every year which make the trade deficit of Nepal even worse. By leveraging AI technologies such as machine learning and data analysis, we can analyze various factors like climate, soil quality, market demand, and available resources. This data-driven approach helps farmers make informed decisions about which crops to plant, increasing agricultural productivity and improving food security. AI algorithms can provide personalized recommendations based on local conditions, enabling farmers to optimize their yields, reduce crop failures, and maximize profits. Ultimately, AI-driven crop selection can contribute to sustainable farming practices, alleviate poverty, and combat hunger in Nepal and similar regions worldwide.</p>

<p>I personally believe that even the uneducated people in the remote parts of the world should get equal opportunity to make their life better leveraging the power of AI and ML. This projects aims to help such people by recommending right kind of crops to maximize their production and profit.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*nWrFYdhySS2t0pb2" alt="" /></p>

<p>In this blog post, we will explore a data science project focused on agricultural crop prediction, highlighting its significance, methodology, and potential benefits.</p>

<h2 id="dataset">Dataset</h2>

<p>The dataset that we’ll be using is: <a href="https://www.kaggle.com/datasets/manikantasanjayv/crop-recommender-dataset-with-soil-nutrients">httpswww.kaggle.com/datasets/manikantasanjayv/crop-recommender-dataset-with-soil-nutrients</a></p>

<p>This is what the dataset looks like:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*xdq-aUBsuNHX04Ti" alt="" /></p>

<h2 id="importing-libraries-and-loading-data">Importing Libraries and Loading Data</h2>

<p>To begin, we import necessary libraries such as NumPy, Pandas, Seaborn, Matplotlib, and IPython Widgets. These libraries will help us manipulate and visualize the data effectively. Additionally, we import the dataset containing soil and climate information using the Pandas library.</p>

<p>import numpy as np</p>

<p>import pandas as pd</p>

<p>import seaborn as sns</p>

<p>import matplotlib.pyplot as plt</p>

<p>from ipywidgets import interact</p>

<p>import warnings</p>

<p>warnings.filterwarnings(‘ignore’)</p>

<p>data=pd.read_csv(“Crop_recommendation.csv”)</p>

<p>Next, we utilize the Pandas DataFrame to calculate and display the average ratios of nitrogen (N), phosphorous (P), and potassium (K) in the soil. These nutrients are essential for plant growth and provide valuable insights into soil fertility. The code snippet then proceeds to calculate and display the average temperature, relative humidity, pH value of the soil, and rainfall. These climatic factors play a crucial role in determining suitable crop choices.</p>

<h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2>

<p>Now ,we utilize the popular data visualization libraries, Matplotlib and Seaborn, to create a grid of subplots. Each subplot represents the distribution of a specific agricultural condition for different crops.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*GNCuGVwoXZJ0oXoS" alt="" /></p>

<p>The first subplot focuses on nitrogen levels (N) in the soil. By utilizing a histogram plot, we can observe the frequency and spread of nitrogen levels across different crops. Similarly, the second subplot showcases the distribution of phosphorous (P) levels, while the third subplot displays the distribution of potassium (K) levels. Moving on to the fourth subplot, it represents the distribution of temperature. Temperature plays a crucial role in crop growth and development, and understanding its distribution helps identify suitable temperature ranges for specific crops. The fifth subplot focuses on rainfall, providing insights into the amount and frequency of precipitation. Next, the sixth subplot examines the distribution of humidity, which is another critical factor affecting crop health and productivity. The seventh subplot visualizes the distribution of soil pH levels. pH level directly influences nutrient availability and crop performance, making it vital to assess its distribution across different crops.</p>

<h2 id="evaluation-metrics">Evaluation Metrics</h2>

<p>Since this is a supervised classification learning, following metrics have been used:</p>

<ol>
  <li>Accuracy</li>
  <li>Precision</li>
  <li>Recall</li>
  <li>F1 Score</li>
</ol>

<h2 id="determining-optimum-clusters">Determining Optimum Clusters</h2>

<p>K-means clustering is a widely used algorithm that partitions data points into clusters based on their similarity. The code snippet begins by importing the necessary libraries, including scikit-learn’s KMeans module. Then, it prepares the data for clustering by removing the labels column and selecting all the values from the dataset. The shape of the data is then printed to gain an understanding of its dimensions.</p>

<p>from sklearn.cluster import KMeans</p>

<p><em>#removing the labels column</em></p>

<p>x = data.drop([‘label’], axis=1)</p>

<p><em>#selecting all the values of data</em></p>

<p>x = x.values</p>

<p><em>#checking the shape</em></p>

<p>print(x.shape)</p>

<p>(2200, 7)</p>

<p>Moving on to the main part of the code, we define an empty list called wcss (Within-Cluster Sum of Squares). This list will store the calculated WCSS values for different numbers of clusters.A loop is then executed from 1 to 10, where each iteration creates a KMeans object with a specific number of clusters. To gain insights into the optimal number of clusters, the Matplotlib library is used to create a line plot.</p>

<p>plt.rcParams[‘figure.figsize’] = (10,4)</p>

<p>wcss = []</p>

<p>for i in range(1,11):</p>

<p>km = KMeans(n_clusters = i, init = ’k-means++’, max_iter = 2000, n_init = 10, random_state = 0)</p>

<p>km.fit(x)</p>

<p>wcss.append(km.inertia_)</p>

<p><em>#Plotting the results</em></p>

<p>plt.plot(range(1,11), wcss)</p>

<p>plt.title(‘Elbow Method’, fontsize = 20)</p>

<p>plt.xlabel(‘No of Clusters’)</p>

<p>plt.ylabel(‘wcss’)</p>

<p>plt.show()</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*GeYDMJpC804vor2u" alt="" /></p>

<p>The resulting plot is known as the Elbow Method plot. It helps us identify the point of inflection or the “elbow” in the curve.</p>

<h2 id="splitting-the-dataset-and-analyzing-correlation">Splitting the Dataset and analyzing correlation</h2>

<p>Next, we split the dataset into input features and target variables for predictive modeling. Additionally, we will analyze the correlations between different variables using a heatmap visualization.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*39K-bUsRVEi0zq5F" alt="" /></p>

<h2 id="data-preprocessing-and-training">Data Preprocessing and Training</h2>

<p>We standardize and tidy up our data to improve model performance.Here, we standardize our data using StandardScaler().The ColumnTransformer is used to create a transformer object that applies the StandardScaler to the numeric columns in the dataset, ensuring that all features are on the same scale.Also, the dataset is split into training and testing sets.</p>

<p>from sklearn.preprocessing import StandardScaler</p>

<p>from sklearn.compose import ColumnTransformer</p>

<p>transformer = ColumnTransformer([(‘num’, StandardScaler(), x.columns)])</p>

<p>Moving on to the model training phase, the code creates an SVM pipeline using the Pipeline module from sklearn.pipeline. The pipeline includes the preprocessing transformer and the SVM model from sklearn.svm. This ensures that the preprocessing steps are seamlessly applied to the data before training the SVM model.</p>

<p>from sklearn.pipeline import Pipeline</p>

<p>from sklearn.svm import SVC</p>

<p>svm_pipe = Pipeline(steps=[(‘preprocessing’, transformer), (‘model’, SVC())])</p>

<p>svm_pipe.fit(x_train, y_train)</p>

<p>y_pred = svm_pipe.predict(x_test)</p>

<p>evaluate_model(“SVM”, y_pred, y_test)</p>

<p>show_confusion_matrix(y_pred, y_test)</p>

<p>Additionally, the show_confusion_matrix() function visualizes the confusion matrix using seaborn’s heatmap. The confusion matrix provides insights into the performance of the model by showing the number of true positives, true negatives, false positives, and false negatives.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*1bdFMRW85QSQjcdX" alt="" /></p>

<p>SVM</p>

<p>accuracy: 0.9772727272727273</p>

<p>f1_score 0.9773200952744351</p>

<p>precision 0.9799524821583645</p>

<p>recall 0.9772727272727273</p>

<p>Decision Tree Classifier</p>

<p>from sklearn.tree import DecisionTreeClassifier</p>

<p>tree_pipe = Pipeline(steps=[(“preprocessing”, transformer), (“model”, DecisionTreeClassifier())])</p>

<p>tree_pipe.fit(x_train, y_train)</p>

<p>y_pred = tree_pipe.predict(x_test)</p>

<p>evaluate_model(“DecisionTreeClassifier” ,y_pred, y_test)</p>

<p>show_confusion_matrix(y_pred, y_test)</p>

<p>DecisionTreeClassifier</p>

<p>accuracy: 0.9886363636363636</p>

<p>f1_score 0.9886072979597981</p>

<p>precision 0.9890874125874125</p>

<p>recall 0.9886363636363636</p>

<h2 id="model-selection">Model Selection</h2>

<p>I played around with different algorithms to see which model fits the data best and generalizes well to test data. Logistic regressions, SVM and decision tree worked well but I chose decision tree classifier model as final model. 98% accuracy in test data proves that the decision tree is generalizing well in real-world examples.</p>

<h2 id="making-predictions-and-displaying-the-suggested-crop">Making predictions and Displaying the suggested Crop</h2>

<p>Finally, we create a dictionary and input values which represent the climatic conditions and the soil nutrients for which we seek crop recommendations. We utilize our trained machine learning model to predict the suggested crop based on the provided climatic data. Since we are using a pipeline, we do not need to perform data preprocessing manually while predicting. The pipeline does the preprocessing and gets the prediction using the learned model. Furthermore, I have saved the weights and biases in a pickle file so that we do not need to train the model every time we need to predict. Once the prediction is made, it prints the suggested crop based on the given climatic conditions.</p>

<p>This is how a user can give input values to get the recommendation:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:1400/0*Iiwk4oXFPMhVpS3O" alt="" /></p>

<h2 id="scope-and-benefits">Scope and benefits</h2>

<ol>
  <li>Enhanced yield</li>
  <li>Risk mitigation</li>
  <li>Sustainable farming practices</li>
  <li>Improved decision making</li>
  <li>The model can continue learning and be better</li>
  <li>Knowledge transfer</li>
  <li>Improved financial condition</li>
  <li>Betterment of the lifestyle of poor communities.</li>
  <li>This is a very lightweight model and is freely available for anyone to use.</li>
</ol>

<h2 id="conclusion">Conclusion</h2>

<p>While crop recommendation systems offer tremendous potential, certain challenges must be addressed. These include the need for reliable data sources, accessibility for farmers in remote areas, and user-friendly interfaces. However, advancements in technology and increased connectivity hold promise for overcoming these obstacles and extending the reach of these systems to a wider user base.</p>

<p>Looking ahead, crop recommendation systems can be further enhanced by incorporating real-time data, remote sensing techniques, and artificial intelligence algorithms. This would provide farmers with even more precise recommendations, leading to better crop management, increased sustainability, and improved food security.</p>

<p>Github repo: <a href="https://github.com/sadhana70/agricultural-crop-recommendation">https://github.com/sadhana70/agricultural-crop-recommendation</a></p>

<p>Code for Nepal would like to thank <a href="https://www.datacamp.com/donates">DataCamp Donates</a> for providing Sadhana, and several other fellows access to DataCamp, to learn and grow.</p>

    </p>
  </div>
</div>
<div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://codefornepal-1.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</div>

	<!-- Footer -->
<footer class="footer" id="footer">
  <div class="container mt-4">
    <div class="row align-items-center">
      <div class="col-md-4">
        <span class="copyright"
          >Copyright &copy; Code for Nepal 2025</span
        >
      </div>

      <!-- Social Media -->
      <div class="col-md-4">
        <ul class="list-inline social-buttons">
          
          <li class="list-inline-item">
            
            <a href="https://twitter.com/codefornepal">
              <i class="fab fa-twitter"></i>
            </a>
            
          </li>
          
          <li class="list-inline-item">
            
            <a href="https://www.facebook.com/codefornepal">
              <i class="fab fa-facebook-f"></i>
            </a>
            
          </li>
          
          <li class="list-inline-item">
            
            <a href="https://www.vimeo.com/codefornepal">
              <i class="fab fa-vimeo-square"></i>
            </a>
            
          </li>
          
          <li class="list-inline-item">
            
            <a href="https://github.com/code4Nepal">
              <i class="fab fa-github"></i>
            </a>
            
          </li>
          
          <li class="list-inline-item">
            
            <a href="http://instagram.com/codefornepal">
              <i class="fab fa-instagram"></i>
            </a>
            
          </li>
          
          <div class="mt-2"><!--Paypal Button-->
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
    <input type="hidden" name="cmd" value="_s-xclick" />
    <input type="hidden" name="hosted_button_id" value="A8L4MMC7NP5ZS"/>
    <button id="donate-btn" class="btn btn-sm btn-primary" type="submit">
      <span>Donate</span>
    </button>
    <img src="https://www.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1" />
  </form>
</div>
        </ul>
      </div>
      
      <!-- Legal -->
      <div class="col-md-4">
        <ul class="list-inline quicklinks">
          <li class="list-inline-item">
            <a href="/codeofconduct/" target="_blank"
              >Code of Conduct</a
            >
          </li>
        </ul>
        <ul class="list-inline quicklinks">
          <li class="list-inline-item">
            <a href="/privacy/" target="_blank"
              >Privacy Policy</a
            >
          </li>
        </ul>
      </div>
      
      <div class="col-md-11 mt-4">
        <span class="code">This work is licensed under a Creative Commons Attribution - ShareAlike 3.0 License! <br>  Code for Nepal is a registered 501(c)(3) nonprofit organization. <br> EIN: 47-3620037</span>
      </div>
    </div>
  </div>
</footer>


<!-- End Footer -->

	<!-- Bootstrap core JavaScript -->
	<script src="/assets/js/jquery.min.js"></script>
	<script src="/assets/js/bootstrap.bundle.min.js"></script>

	<!-- Plugin JavaScript -->
	<script src="/assets/js/jquery.easing.min.js"></script>

	<!-- Contact form JavaScript -->
	<script src="/assets/js/jqBootstrapValidation.js"></script>
	<script src="/assets/js/contact_me.js"></script>

	<!-- Custom scripts for this template -->
	<script src="/assets/js/agency.min.js"></script>

</body>

</html>